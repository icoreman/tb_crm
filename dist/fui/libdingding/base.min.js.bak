function getQueryString(name){var reg=new RegExp("(^|&)"+name+"=([^&]*)(&|$)","i");var r=window.location.search.substr(1).match(reg);if(r!=null){return unescape(r[2])}return null}var contextPath="";document.getElementById("context").value=contextPath;var corpid=getQueryString("corpid");var hash="f09cf7bb84a74fbe5285";var _config;var url=window.location.href;var indexpos=url.indexOf("#");if(indexpos>0){url=url.substring(0,indexpos)}var suiteKey="";var appid=getQueryString("appid");if(appid==3907){suiteKey="suitecq7s4oxjml7fuxph"}if(appid==3944){suiteKey="suitehg6xf9ztjjswepxq"}if(appid==3906||appid==4024||appid==4025){suiteKey="suitettsty8kmffyfiven"}if(appid==3943){suiteKey="suitekiwm4va2gobjwaxm"}if(appid==3905){suiteKey="suite6vbaqzdreygzzz2q"}if(appid==3942){suiteKey="suitedzp4w2ovg0hnautn"}if(appid==3835||appid==3844||appid==3845){suiteKey="suitexezzlmy6ftlkv0zc"}if(appid==4048){suiteKey="suitecmgwaty0he0eh1zd"}if(appid==4049){suiteKey="suited1ldwvcwsrn1wvgy"}if(appid==4047){suiteKey="suitersgovwhh7rf7pu25"}if(appid==3992){suiteKey="suitep41lhgkbzhgs9uma"}if(appid==4427){suiteKey="suitettsty8kmffyfiven"}function savedata(){var corpid=getQueryString("corpid");var appid=getQueryString("appid");var suiteKey;if(appid==3907){suiteKey="suitecq7s4oxjml7fuxph"}if(appid==3944){suiteKey="suitehg6xf9ztjjswepxq"}if(appid==3906){suiteKey="suitettsty8kmffyfiven"}if(appid==3943){suiteKey="suitekiwm4va2gobjwaxm"}if(appid==3905){suiteKey="suite6vbaqzdreygzzz2q"}if(appid==3942){suiteKey="suitedzp4w2ovg0hnautn"}if(appid==3835||appid==3844||appid==3845){suiteKey="suitexezzlmy6ftlkv0zc"}if(appid==4048){suiteKey="suitecmgwaty0he0eh1zd"}if(appid==4049){suiteKey="suited1ldwvcwsrn1wvgy"}if(appid==4047){suiteKey="suitersgovwhh7rf7pu25"}if(appid==3992){suiteKey="suitep41lhgkbzhgs9uma"}if(appid==4427){suiteKey="suitettsty8kmffyfiven"}dd.util.domainStorage.setItem({name:"suiteKey",value:suiteKey,onSuccess:function(info){},onFail:function(err){}});dd.util.domainStorage.setItem({name:"corpid",value:corpid,onSuccess:function(info){},onFail:function(err){}});dd.util.domainStorage.setItem({name:"appid",value:appid,onSuccess:function(info){},onFail:function(err){}})}function jsready(callback,apid){var appid=apid;if(apid!=null){}else{appid=getQueryString("appid")}if(appid==3907){suiteKey="suitecq7s4oxjml7fuxph"}if(appid==3944){suiteKey="suitehg6xf9ztjjswepxq"}if(appid==3906){suiteKey="suitettsty8kmffyfiven"}if(appid==3943){suiteKey="suitekiwm4va2gobjwaxm"}if(appid==3905){suiteKey="suite6vbaqzdreygzzz2q"}if(appid==3942){suiteKey="suitedzp4w2ovg0hnautn"}if(appid==4048){suiteKey="suitecmgwaty0he0eh1zd"}if(appid==4049){suiteKey="suited1ldwvcwsrn1wvgy"}if(appid==4047){suiteKey="suitersgovwhh7rf7pu25"}if(appid==3835||appid==3844||appid==3845){suiteKey="suitexezzlmy6ftlkv0zc"}if(appid==3992){suiteKey="suitep41lhgkbzhgs9uma"}if(appid==4427){suiteKey="suitettsty8kmffyfiven"}var url=window.location.href;var indexpos=url.indexOf("#");if(indexpos>0){url=url.substring(0,indexpos)}$.post(contextPath+"/dingisv/api/common/get_jsconfig",{"url":url,"corpId":corpid,"suiteKey":suiteKey,"appId":appid},function(result){_config=JSON.parse(result);dd.error(function(err){console.log("dd error: "+JSON.stringify(err))});dd.config({agentId:_config.agentId,corpId:_config.corpId,timeStamp:_config.timeStamp,nonceStr:_config.nonce,signature:_config.signature,jsApiList:["runtime.info","biz.util.openLink","biz.navigation.setLeft","biz.navigation.setTitle","biz.navigation.setRight","device.notification.confirm","device.notification.alert","biz.util.share","ui.webViewBounce","ui.webViewBounce.disable","biz.contact.choose","biz.util.uploadImage","biz.util.previewImage","biz.cspace.preview","biz.contact.departmentsPicker","biz.contact.complexPicker","biz.util.uploadAttachment","biz.customContact.choose"]});dd.ready(function(){if(callback!=undefined){callback()}})})}function allowupload(callback){$.ajax({url:contextPath+"/dingisv/api/common/grant_custom_space",type:"GET",success:function(data,status,xhr){callback(data)},error:function(xhr,errorType,error){console.log("error:"+errorType+", "+error)}})}function allowdownload(callback){$.ajax({url:contextPath+"/dingisv/api/common/grant_custom_space?type=download",type:"GET",success:function(data,status,xhr){callback(data)},error:function(xhr,errorType,error){console.log("error:"+errorType+", "+error)}})}function allowdownload(callback,agentid){var url=contextPath+"/dingisv/api/common/grant_custom_space_download?type=download";if(agentid!=null){url=url+"&agentid="+agentid}if(appid!=null){url=url+"&appid="+appod}$.ajax({url:url,type:"GET",success:function(data,status,xhr){callback(data)},error:function(xhr,errorType,error){console.log("error:"+errorType+", "+error)}})}function pageSkip(urlHash){var url1=url.replace("index.html","dist/detail.html");dd.biz.util.openLink({url:url1+urlHash,onSuccess:function(result){},onFail:function(err){}})}function downloadFile(id){var convertType=1;dd.device.notification.showPreloader({text:"文件转码中..",showIcon:true,onSuccess:function(result){},onFail:function(err){}});
$.ajax({type:"GET",url:contextPath+"/fileview/convert",data:{"input":id,"convertType":convertType,},cache:false,dataType:"json",success:function(data){dd.device.notification.hidePreloader({onSuccess:function(result){},onFail:function(err){}});console.info(data);if(data.result==0){data.data=window.location.protocol+"//"+window.location.host+"/"+contextPath+"/fileview/realPath?pathId="+data.data;dd.biz.util.openLink({url:data.data,onSuccess:function(result){},onFail:function(err){}})}else{alert(data.message)}},error:function(){dd.device.notification.hidePreloader({onSuccess:function(result){},onFail:function(err){}});console.log("异常！")}})}function getAllPath(urlHash){var url1=url.replace("index.html","dist/detail.html");return url1+urlHash}function login(callback,module){dd.runtime.permission.requestAuthCode({corpId:corpid,onSuccess:function(info){var loginurl=contextPath+"/dingisv/api/common/get_user?code="+info.code+"&corpId="+corpid+"&suiteKey="+suiteKey;if(module!=undefined){loginurl=loginurl+"&module="+module}$.ajax({url:loginurl,type:"GET",success:function(data,status,xhr){callback(data)},error:function(xhr,errorType,error){console.log("error:"+errorType+", "+error)}})},onFail:function(err){console.log("fail: "+JSON.stringify(err))}})}function getUser(callback){$.ajax({url:contextPath+"/dingisv/api/common/getSession?corpId="+corpid+"&suiteKey="+suiteKey,type:"GET",success:function(data,status,xhr){callback(data)},error:function(xhr,errorType,error){console.log("error:"+errorType+", "+error)}})}function copyflow(callback){$.ajax({url:contextPath+"/dingisv/api/common/get_flow?corpId="+corpid+"&suiteKey="+suiteKey,type:"GET",success:function(data,status,xhr){callback(data)},error:function(xhr,errorType,error){console.log("error:"+errorType+", "+error)}})}function isEmojiCharacter(substring){for(var i=0;i<substring.length;i++){var hs=substring.charCodeAt(i);if(55296<=hs&&hs<=56319){if(substring.length>1){var ls=substring.charCodeAt(i+1);var uc=((hs-55296)*1024)+(ls-56320)+65536;if(118784<=uc&&uc<=128895){return true}}}else{if(substring.length>1){var ls=substring.charCodeAt(i+1);if(ls==8419){return true}}else{if(8448<=hs&&hs<=10239){return true}else{if(11013<=hs&&hs<=11015){return true}else{if(10548<=hs&&hs<=10549){return true}else{if(12951<=hs&&hs<=12953){return true}else{if(hs==169||hs==174||hs==12349||hs==12336||hs==11093||hs==11036||hs==11035||hs==11088){return true}}}}}}}}};