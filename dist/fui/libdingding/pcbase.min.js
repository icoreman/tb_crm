function getQueryString(name){var reg=new RegExp("(^|&)"+name+"=([^&]*)(&|$)","i");var r=window.location.search.substr(1).match(reg);if(r!=null){return unescape(r[2])}return null}var contextPath=getQueryString("contextPath");if(typeof(contextPath)=="undefined"||contextPath==null||contextPath==""){contextPath=""}else{contextPath="/"+contextPath}var corpid=getQueryString("corpid");var hash="f09cf7bb84a74fbe5285";var _config;var url=window.location.href;var indexpos=url.indexOf("#");if(indexpos>0){url=url.substring(0,indexpos)}var suiteKey="";var appid=getQueryString("appid");if(appid==3907){suiteKey="suitecq7s4oxjml7fuxph"}if(appid==3944){suiteKey="suitehg6xf9ztjjswepxq"}if(appid==3906||appid==4024||appid==4025){suiteKey="suitettsty8kmffyfiven"}if(appid==3943){suiteKey="suitekiwm4va2gobjwaxm"}if(appid==3905){suiteKey="suite6vbaqzdreygzzz2q"}if(appid==3942){suiteKey="suitedzp4w2ovg0hnautn"}if(appid==3835||appid==3844||appid==3845){suiteKey="suitexezzlmy6ftlkv0zc"}if(appid==4048){suiteKey="suitecmgwaty0he0eh1zd"}if(appid==4049){suiteKey="suited1ldwvcwsrn1wvgy"}if(appid==4047){suiteKey="suitersgovwhh7rf7pu25"}if(appid==3992){suiteKey="suitep41lhgkbzhgs9uma"}if(appid==5540){suiteKey="suitepgkopqukd5anyath"}if(appid==5541){suiteKey="suitepgkopqukd5anyath"}if(appid==5542){suiteKey="suitepgkopqukd5anyath"}if(appid==5543){suiteKey="suitepgkopqukd5anyath"}if(appid==5544){suiteKey="suitepgkopqukd5anyath"}if(appid==5545){suiteKey="suitepgkopqukd5anyath"}if(appid==5546){suiteKey="suitepgkopqukd5anyath"}if(appid==5548){suiteKey="suitepgkopqukd5anyath"}if(appid==5549){suiteKey="suitepgkopqukd5anyath"}if(appid==5550){suiteKey="suitepgkopqukd5anyath"}function savedata(){var corpid=getQueryString("corpid");var appid=getQueryString("appid");var suiteKey;if(appid==3907){suiteKey="suitecq7s4oxjml7fuxph"}if(appid==3944){suiteKey="suitehg6xf9ztjjswepxq"}if(appid==3906){suiteKey="suitettsty8kmffyfiven"}if(appid==3943){suiteKey="suitekiwm4va2gobjwaxm"}if(appid==3905){suiteKey="suite6vbaqzdreygzzz2q"}if(appid==3942){suiteKey="suitedzp4w2ovg0hnautn"}if(appid==3835||appid==3844||appid==3845){suiteKey="suitexezzlmy6ftlkv0zc"}if(appid==4048){suiteKey="suitecmgwaty0he0eh1zd"}if(appid==4049){suiteKey="suited1ldwvcwsrn1wvgy"}if(appid==4047){suiteKey="suitersgovwhh7rf7pu25"}DingTalkPC.util.domainStorage.setItem({name:"suiteKey",value:suiteKey,onSuccess:function(info){},onFail:function(err){}});DingTalkPC.util.domainStorage.setItem({name:"corpid",value:corpid,onSuccess:function(info){},onFail:function(err){}});DingTalkPC.util.domainStorage.setItem({name:"appid",value:appid,onSuccess:function(info){},onFail:function(err){}})}function jsready(callback){$.post(contextPath+"/dingisv/api/common/get_jsconfig",{"url":url,"corpId":corpid,"suiteKey":suiteKey,"appId":appid},function(result){_config=JSON.parse(result);DingTalkPC.error(function(err){alert("dd error: "+JSON.stringify(err))});DingTalkPC.config({agentId:_config.agentId,corpId:_config.corpId,timeStamp:_config.timeStamp,nonceStr:_config.nonce,signature:_config.signature,jsApiList:["runtime.info","biz.util.openLink","biz.navigation.setLeft","biz.navigation.setTitle","biz.navigation.setRight","device.notification.confirm","device.notification.alert","biz.util.share","ui.webViewBounce","ui.webViewBounce.disable","biz.contact.choose","biz.util.uploadImage","biz.util.previewImage","biz.contact.departmentsPicker","biz.util.uploadAttachment","biz.cspace.preview","biz.customContact.choose"]});DingTalkPC.ready(function(){if(callback!=undefined){callback()}})})}function allowupload(callback){$.ajax({url:contextPath+"/dingisv/api/common/grant_custom_space",type:"GET",success:function(data,status,xhr){callback(data)},error:function(xhr,errorType,error){alert("error:"+errorType+", "+error)}})}function allowdownload(callback){$.ajax({url:contextPath+"/dingisv/api/common/grant_custom_space?type=download",type:"GET",success:function(data,status,xhr){callback(data)},error:function(xhr,errorType,error){alert("error:"+errorType+", "+error)}})}function login(callback,module){DingTalkPC.runtime.permission.requestAuthCode({corpId:corpid,onSuccess:function(info){var loginurl=contextPath+"/dingisv/api/common/get_user?code="+info.code+"&corpId="+corpid+"&suiteKey="+suiteKey;if(module!=undefined){loginurl=loginurl+"&module="+module}$.ajax({url:loginurl,type:"GET",success:function(data,status,xhr){callback(data)},error:function(xhr,errorType,error){alert("error:"+errorType+", "+error)}})},onFail:function(err){alert("fail: "+JSON.stringify(err))}})}function copyflow(callback){$.ajax({url:contextPath+"/dingisv/api/common/get_flow?corpId="+corpid+"&suiteKey="+suiteKey,type:"GET",success:function(data,status,xhr){callback(data)},error:function(xhr,errorType,error){alert("error:"+errorType+", "+error)}})};